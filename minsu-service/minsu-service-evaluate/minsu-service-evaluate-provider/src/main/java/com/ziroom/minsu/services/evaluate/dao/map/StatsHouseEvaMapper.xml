<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="evaluate.statsHouseEvaDao" >
  <resultMap id="BaseResultMap" type="com.ziroom.minsu.entity.evaluate.StatsHouseEvaEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 08 17:02:28 CST 2016.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="fid" property="fid" jdbcType="VARCHAR" />
    <result column="house_fid" property="houseFid" jdbcType="VARCHAR" />
    <result column="room_fid" property="roomFid" jdbcType="VARCHAR" />
    <result column="bed_fid" property="bedFid" jdbcType="VARCHAR" />
    <result column="house_clean_ava" property="houseCleanAva" jdbcType="REAL" />
    <result column="des_match_ava" property="desMatchAva" jdbcType="REAL" />
    <result column="safe_degree_ava" property="safeDegreeAva" jdbcType="REAL" />
    <result column="traf_pos_ava" property="trafPosAva" jdbcType="REAL" />
    <result column="cost_perfor_ava" property="costPerforAva" jdbcType="REAL" />
    <result column="eva_four_avage" property="evaFourAvage" jdbcType="REAL" />
    <result column="eva_five_avage" property="evaFiveAvage" jdbcType="REAL" />
    <result column="rent_way" property="rentWay" jdbcType="INTEGER" />
    <result column="landlord_uid" property="landlordUid" jdbcType="VARCHAR" />
    <result column="house_clean_tal" property="houseCleanTal" jdbcType="INTEGER" />
    <result column="des_math_tal" property="desMathTal" jdbcType="INTEGER" />
    <result column="safe_degree_tal" property="safeDegreeTal" jdbcType="INTEGER" />
    <result column="traf_pos_tal" property="trafPosTal" jdbcType="INTEGER" />
    <result column="cost_perfor_tal" property="costPerforTal" jdbcType="INTEGER" />
    <result column="eva_four_tal" property="evaFourTal" jdbcType="INTEGER" />
    <result column="eva_five_tal" property="evaFiveTal" jdbcType="INTEGER" />
    <result column="eva_total" property="evaTotal" jdbcType="INTEGER" />
    <result column="last_modify_date" property="lastModifyDate" jdbcType="TIMESTAMP" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 08 17:02:28 CST 2016.
    -->
    id, fid, house_fid, room_fid, bed_fid, house_clean_ava, des_match_ava, safe_degree_ava, 
    traf_pos_ava, cost_perfor_ava, eva_four_avage, eva_five_avage, rent_way, landlord_uid, 
    house_clean_tal, des_math_tal, safe_degree_tal, traf_pos_tal, cost_perfor_tal, eva_four_tal, 
    eva_five_tal, eva_total, last_modify_date, create_time
  </sql>
  <sql id="select_condition">
  
   <if test="houseFid != null" >
    AND house_fid = #{houseFid,jdbcType=VARCHAR}
   </if>
    <if test="rentWay != null" >
      AND rent_way = #{rentWay,jdbcType=INTEGER}
    </if>
    <if test="fid != null" >
     AND  fid = #{fid,jdbcType=VARCHAR}
    </if>
    <if test="roomFid != null" >
    AND  room_fid = #{roomFid,jdbcType=VARCHAR}
    </if>
    <if test="bedFid != null" >
    AND  bed_fid = #{bedFid,jdbcType=VARCHAR}
    </if>
    <if test="landlordUid != null" >
     AND   landlord_uid = #{landlordUid,jdbcType=VARCHAR}
    </if>
  </sql>
 
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 08 17:02:28 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from t_stats_house_eva
    where id = #{id,jdbcType=INTEGER}
  </select>
  <select id="queryByCondition" resultMap="BaseResultMap" parameterType="com.ziroom.minsu.services.evaluate.dto.StatsHouseEvaRequest" >
    <!-- 条件查找 -->
    select 
    <include refid="Base_Column_List" />
    from t_stats_house_eva
     WHERE 1=1
    <include refid="select_condition" />
    
  </select>

  <delete id="delHouseStatByFid" parameterType="com.ziroom.minsu.entity.evaluate.StatsHouseEvaEntity" >
    delete from t_stats_house_eva
    where fid = #{fid,jdbcType=VARCHAR}
  </delete>
 
  <insert id="insert" parameterType="com.ziroom.minsu.entity.evaluate.StatsHouseEvaEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 08 17:02:28 CST 2016.
    -->
    insert into t_stats_house_eva (id, fid, house_fid, 
      room_fid, bed_fid, house_clean_ava, 
      des_match_ava, safe_degree_ava, traf_pos_ava, 
      cost_perfor_ava, eva_four_avage, eva_five_avage, 
      rent_way, landlord_uid, house_clean_tal, 
      des_math_tal, safe_degree_tal, traf_pos_tal, 
      cost_perfor_tal, eva_four_tal, eva_five_tal, 
      eva_total, last_modify_date, create_time
      )
    values (#{id,jdbcType=INTEGER}, #{fid,jdbcType=VARCHAR}, #{houseFid,jdbcType=VARCHAR}, 
      #{roomFid,jdbcType=VARCHAR}, #{bedFid,jdbcType=VARCHAR}, #{houseCleanAva,jdbcType=REAL}, 
      #{desMatchAva,jdbcType=REAL}, #{safeDegreeAva,jdbcType=REAL}, #{trafPosAva,jdbcType=REAL}, 
      #{costPerforAva,jdbcType=REAL}, #{evaFourAvage,jdbcType=REAL}, #{evaFiveAvage,jdbcType=REAL}, 
      #{rentWay,jdbcType=INTEGER}, #{landlordUid,jdbcType=VARCHAR}, #{houseCleanTal,jdbcType=INTEGER}, 
      #{desMathTal,jdbcType=INTEGER}, #{safeDegreeTal,jdbcType=INTEGER}, #{trafPosTal,jdbcType=INTEGER}, 
      #{costPerforTal,jdbcType=INTEGER}, #{evaFourTal,jdbcType=INTEGER}, #{evaFiveTal,jdbcType=INTEGER}, 
      #{evaTotal,jdbcType=INTEGER}, #{lastModifyDate,jdbcType=TIMESTAMP}, #{createTime,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.ziroom.minsu.entity.evaluate.StatsHouseEvaEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 08 17:02:28 CST 2016.
    -->
    insert into t_stats_house_eva
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="fid != null" >
        fid,
      </if>
      <if test="houseFid != null" >
        house_fid,
      </if>
      <if test="roomFid != null" >
        room_fid,
      </if>
      <if test="bedFid != null" >
        bed_fid,
      </if>
      <if test="houseCleanAva != null" >
        house_clean_ava,
      </if>
      <if test="desMatchAva != null" >
        des_match_ava,
      </if>
      <if test="safeDegreeAva != null" >
        safe_degree_ava,
      </if>
      <if test="trafPosAva != null" >
        traf_pos_ava,
      </if>
      <if test="costPerforAva != null" >
        cost_perfor_ava,
      </if>
      <if test="evaFourAvage != null" >
        eva_four_avage,
      </if>
      <if test="evaFiveAvage != null" >
        eva_five_avage,
      </if>
      <if test="rentWay != null" >
        rent_way,
      </if>
      <if test="landlordUid != null" >
        landlord_uid,
      </if>
      <if test="houseCleanTal != null" >
        house_clean_tal,
      </if>
      <if test="desMathTal != null" >
        des_math_tal,
      </if>
      <if test="safeDegreeTal != null" >
        safe_degree_tal,
      </if>
      <if test="trafPosTal != null" >
        traf_pos_tal,
      </if>
      <if test="costPerforTal != null" >
        cost_perfor_tal,
      </if>
      <if test="evaFourTal != null" >
        eva_four_tal,
      </if>
      <if test="evaFiveTal != null" >
        eva_five_tal,
      </if>
      <if test="evaTotal != null" >
        eva_total,
      </if>
      <if test="lastModifyDate != null" >
        last_modify_date,
      </if>
      <if test="createTime != null" >
        create_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="fid != null" >
        #{fid,jdbcType=VARCHAR},
      </if>
      <if test="houseFid != null" >
        #{houseFid,jdbcType=VARCHAR},
      </if>
      <if test="roomFid != null" >
        #{roomFid,jdbcType=VARCHAR},
      </if>
      <if test="bedFid != null" >
        #{bedFid,jdbcType=VARCHAR},
      </if>
      <if test="houseCleanAva != null" >
        #{houseCleanAva,jdbcType=REAL},
      </if>
      <if test="desMatchAva != null" >
        #{desMatchAva,jdbcType=REAL},
      </if>
      <if test="safeDegreeAva != null" >
        #{safeDegreeAva,jdbcType=REAL},
      </if>
      <if test="trafPosAva != null" >
        #{trafPosAva,jdbcType=REAL},
      </if>
      <if test="costPerforAva != null" >
        #{costPerforAva,jdbcType=REAL},
      </if>
      <if test="evaFourAvage != null" >
        #{evaFourAvage,jdbcType=REAL},
      </if>
      <if test="evaFiveAvage != null" >
        #{evaFiveAvage,jdbcType=REAL},
      </if>
      <if test="rentWay != null" >
        #{rentWay,jdbcType=INTEGER},
      </if>
      <if test="landlordUid != null" >
        #{landlordUid,jdbcType=VARCHAR},
      </if>
      <if test="houseCleanTal != null" >
        #{houseCleanTal,jdbcType=INTEGER},
      </if>
      <if test="desMathTal != null" >
        #{desMathTal,jdbcType=INTEGER},
      </if>
      <if test="safeDegreeTal != null" >
        #{safeDegreeTal,jdbcType=INTEGER},
      </if>
      <if test="trafPosTal != null" >
        #{trafPosTal,jdbcType=INTEGER},
      </if>
      <if test="costPerforTal != null" >
        #{costPerforTal,jdbcType=INTEGER},
      </if>
      <if test="evaFourTal != null" >
        #{evaFourTal,jdbcType=INTEGER},
      </if>
      <if test="evaFiveTal != null" >
        #{evaFiveTal,jdbcType=INTEGER},
      </if>
      <if test="evaTotal != null" >
        #{evaTotal,jdbcType=INTEGER},
      </if>
      <if test="lastModifyDate != null" >
        #{lastModifyDate,jdbcType=TIMESTAMP},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  
 
  
  <update id="updateBySelective" parameterType="com.ziroom.minsu.entity.evaluate.StatsHouseEvaEntity" >
    <!-- 选择性更新  更新前一定要有条件 没有条件 dao不要让更新 一旦无条件 所有记录都被更新了 更新前先去查记录-->
    update t_stats_house_eva
    <set >
      <if test="houseCleanAva != null" >
        house_clean_ava = #{houseCleanAva,jdbcType=REAL},
      </if>
      <if test="desMatchAva != null" >
        des_match_ava = #{desMatchAva,jdbcType=REAL},
      </if>
      <if test="safeDegreeAva != null" >
        safe_degree_ava = #{safeDegreeAva,jdbcType=REAL},
      </if>
      <if test="trafPosAva != null" >
        traf_pos_ava = #{trafPosAva,jdbcType=REAL},
      </if>
      <if test="costPerforAva != null" >
        cost_perfor_ava = #{costPerforAva,jdbcType=REAL},
      </if>
      <if test="evaFourAvage != null" >
        eva_four_avage = #{evaFourAvage,jdbcType=REAL},
      </if>
      <if test="evaFiveAvage != null" >
        eva_five_avage = #{evaFiveAvage,jdbcType=REAL},
      </if>
      <if test="houseCleanTal != null" >
        house_clean_tal = #{houseCleanTal,jdbcType=INTEGER},
      </if>
      <if test="desMathTal != null" >
        des_math_tal = #{desMathTal,jdbcType=INTEGER},
      </if>
      <if test="safeDegreeTal != null" >
        safe_degree_tal = #{safeDegreeTal,jdbcType=INTEGER},
      </if>
      <if test="trafPosTal != null" >
        traf_pos_tal = #{trafPosTal,jdbcType=INTEGER},
      </if>
      <if test="costPerforTal != null" >
        cost_perfor_tal = #{costPerforTal,jdbcType=INTEGER},
      </if>
      <if test="evaFourTal != null" >
        eva_four_tal = #{evaFourTal,jdbcType=INTEGER},
      </if>
      <if test="evaFiveTal != null" >
        eva_five_tal = #{evaFiveTal,jdbcType=INTEGER},
      </if>
      <if test="evaTotal != null" >
        eva_total = #{evaTotal,jdbcType=INTEGER},
      </if>
      <if test="lastModifyDate != null" >
        last_modify_date = #{lastModifyDate,jdbcType=TIMESTAMP},
      </if>
    </set>
    WHERE 1=1
    <include refid="select_condition" />
  </update>
  
 
  <update id="updateByPrimaryKeySelective" parameterType="com.ziroom.minsu.entity.evaluate.StatsHouseEvaEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 08 17:02:28 CST 2016.
    -->
    update t_stats_house_eva
    <set >
      <if test="fid != null" >
        fid = #{fid,jdbcType=VARCHAR},
      </if>
      <if test="houseFid != null" >
        house_fid = #{houseFid,jdbcType=VARCHAR},
      </if>
      <if test="roomFid != null" >
        room_fid = #{roomFid,jdbcType=VARCHAR},
      </if>
      <if test="bedFid != null" >
        bed_fid = #{bedFid,jdbcType=VARCHAR},
      </if>
      <if test="houseCleanAva != null" >
        house_clean_ava = #{houseCleanAva,jdbcType=REAL},
      </if>
      <if test="desMatchAva != null" >
        des_match_ava = #{desMatchAva,jdbcType=REAL},
      </if>
      <if test="safeDegreeAva != null" >
        safe_degree_ava = #{safeDegreeAva,jdbcType=REAL},
      </if>
      <if test="trafPosAva != null" >
        traf_pos_ava = #{trafPosAva,jdbcType=REAL},
      </if>
      <if test="costPerforAva != null" >
        cost_perfor_ava = #{costPerforAva,jdbcType=REAL},
      </if>
      <if test="evaFourAvage != null" >
        eva_four_avage = #{evaFourAvage,jdbcType=REAL},
      </if>
      <if test="evaFiveAvage != null" >
        eva_five_avage = #{evaFiveAvage,jdbcType=REAL},
      </if>
      <if test="rentWay != null" >
        rent_way = #{rentWay,jdbcType=INTEGER},
      </if>
      <if test="landlordUid != null" >
        landlord_uid = #{landlordUid,jdbcType=VARCHAR},
      </if>
      <if test="houseCleanTal != null" >
        house_clean_tal = #{houseCleanTal,jdbcType=INTEGER},
      </if>
      <if test="desMathTal != null" >
        des_math_tal = #{desMathTal,jdbcType=INTEGER},
      </if>
      <if test="safeDegreeTal != null" >
        safe_degree_tal = #{safeDegreeTal,jdbcType=INTEGER},
      </if>
      <if test="trafPosTal != null" >
        traf_pos_tal = #{trafPosTal,jdbcType=INTEGER},
      </if>
      <if test="costPerforTal != null" >
        cost_perfor_tal = #{costPerforTal,jdbcType=INTEGER},
      </if>
      <if test="evaFourTal != null" >
        eva_four_tal = #{evaFourTal,jdbcType=INTEGER},
      </if>
      <if test="evaFiveTal != null" >
        eva_five_tal = #{evaFiveTal,jdbcType=INTEGER},
      </if>
      <if test="evaTotal != null" >
        eva_total = #{evaTotal,jdbcType=INTEGER},
      </if>
      <if test="lastModifyDate != null" >
        last_modify_date = #{lastModifyDate,jdbcType=TIMESTAMP},
      </if>
      <if test="createTime != null" >
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ziroom.minsu.entity.evaluate.StatsHouseEvaEntity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 08 17:02:28 CST 2016.
    -->
    update t_stats_house_eva
    set fid = #{fid,jdbcType=VARCHAR},
      house_fid = #{houseFid,jdbcType=VARCHAR},
      room_fid = #{roomFid,jdbcType=VARCHAR},
      bed_fid = #{bedFid,jdbcType=VARCHAR},
      house_clean_ava = #{houseCleanAva,jdbcType=REAL},
      des_match_ava = #{desMatchAva,jdbcType=REAL},
      safe_degree_ava = #{safeDegreeAva,jdbcType=REAL},
      traf_pos_ava = #{trafPosAva,jdbcType=REAL},
      cost_perfor_ava = #{costPerforAva,jdbcType=REAL},
      eva_four_avage = #{evaFourAvage,jdbcType=REAL},
      eva_five_avage = #{evaFiveAvage,jdbcType=REAL},
      rent_way = #{rentWay,jdbcType=INTEGER},
      landlord_uid = #{landlordUid,jdbcType=VARCHAR},
      house_clean_tal = #{houseCleanTal,jdbcType=INTEGER},
      des_math_tal = #{desMathTal,jdbcType=INTEGER},
      safe_degree_tal = #{safeDegreeTal,jdbcType=INTEGER},
      traf_pos_tal = #{trafPosTal,jdbcType=INTEGER},
      cost_perfor_tal = #{costPerforTal,jdbcType=INTEGER},
      eva_four_tal = #{evaFourTal,jdbcType=INTEGER},
      eva_five_tal = #{evaFiveTal,jdbcType=INTEGER},
      eva_total = #{evaTotal,jdbcType=INTEGER},
      last_modify_date = #{lastModifyDate,jdbcType=TIMESTAMP},
      create_time = #{createTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=INTEGER}
  </update>
  
  <!-- 根据房东uid查询房东的平均分数  -->
  <select id="selectByAVEScoreByUid" resultType="java.lang.Float"  parameterType="java.lang.String" >
     SELECT SUM(e.house_clean_tal+e.des_math_tal+e.safe_degree_tal+e.traf_pos_tal+e.cost_perfor_tal)/SUM(e.eva_total)/5 
     FROM t_stats_house_eva e 
     WHERE e.landlord_uid = #{landlordUid,jdbcType=VARCHAR}
  </select>
  
</mapper>